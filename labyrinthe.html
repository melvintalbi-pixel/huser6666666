<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Labyrinthe Hardcore — Fullscreen PC</title>
<style>
  :root{
    --bg:#050304;
    --wall:#0b0705;
    --floor:#2b2218;
    --player:#f6e6b2;
    --trap:#7b1420;
    --exit:#0b6b33;
    --text:#efe6c9;
    --accent:#b98a26;
  }
  html, body { margin:0; padding:0; height:100%; overflow:hidden; background:var(--bg); font-family:"Papyrus",sans-serif; color:var(--text);}
  #grid {
    display:grid;
    grid-template-columns: repeat(20, 32px);
    grid-template-rows: repeat(20, 32px);
    gap:2px;
    width:100vw;
    height:100vh;
  }
  .cell { width:32px; height:32px; border-radius:2px; }
  .wall { background:var(--wall); }
  .empty { background:var(--floor); }
  .player { background:var(--player); box-shadow:0 0 8px #d4af37; }
  .trap { background:var(--trap); }
  .exit { background:var(--exit); }
  #modalBackdrop { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.85); justify-content:center; align-items:center; z-index:200; }
  #modal { background:linear-gradient(180deg,#22160f,#0f0b08); padding:18px;border-radius:10px;border:2px solid rgba(185,138,38,0.18); width:360px; color:var(--text); text-align:center; }
  #modal h2 { color:var(--accent); margin:6px 0; }
  #modal input { padding:8px; border-radius:6px; border:1px solid #333; margin-top:10px; width:80%; text-align:center; }
  #modal button { margin-top:12px; padding:8px 12px; border-radius:6px; border:none; background:var(--accent); color:#000; cursor:pointer; }
</style>
</head>
<body>
<div id="grid"></div>

<div id="modalBackdrop">
  <div id="modal"></div>
</div>

<script>
const ROWS = 21; // interne impaire pour maze
const COLS = 21;
const gridEl = document.getElementById('grid');
const modalBackdrop = document.getElementById('modalBackdrop');
const modal = document.getElementById('modal');

let maze = [];
let player = {r:1,c:1};
let trapDone = false;

// génération maze parfait (recursive backtracker)
function initMaze() {
  maze = Array.from({length:ROWS},()=>Array(COLS).fill('wall'));
  function carve(r,c){
    maze[r][c]='empty';
    const dirs = [[0,2],[0,-2],[2,0],[-2,0]];
    dirs.sort(()=>Math.random()-0.5);
    for(const [dr,dc] of dirs){
      const nr=r+dr, nc=c+dc;
      if(nr>0 && nr<ROWS-1 && nc>0 && nc<COLS-1 && maze[nr][nc]==='wall'){
        maze[r+dr/2][c+dc/2]='empty';
        carve(nr,nc);
      }
    }
  }
  carve(1,1);
  // placer sortie
  maze[ROWS-2][COLS-2]='exit';
  // placer trap obligatoire au centre du labyrinthe
  const trapR = Math.floor(ROWS/2);
  const trapC = Math.floor(COLS/2);
  maze[trapR][trapC]='trap';
}
function renderMaze(){
  gridEl.innerHTML='';
  for(let r=0;r<ROWS;r++){
    for(let c=0;c<COLS;c++){
      const div=document.createElement('div');
      div.classList.add('cell',maze[r][c]);
      if(r===player.r && c===player.c) div.classList.add('player');
      div.dataset.r=r; div.dataset.c=c;
      gridEl.appendChild(div);
    }
  }
}
function move(dr,dc){
  const nr=player.r+dr, nc=player.c+dc;
  if(nr<0||nc<0||nr>=ROWS||nc>=COLS) return;
  const type = maze[nr][nc];
  if(type==='wall') return;
  if(type==='trap' && !trapDone){
    trapDone=true;
    showTrapPuzzle();
    return;
  }
  player.r=nr; player.c=nc;
  renderMaze();
  if(type==='exit') showExit();
}
function showTrapPuzzle(){
  modal.innerHTML=`
    <h2>Piège Mathématique</h2>
    <p>Pour continuer, entre le chiffre mystère : 6666666</p>
    <input id="trapInput" placeholder="?" />
    <br/><button id="trapBtn">Valider</button>
  `;
  modalBackdrop.style.display='flex';
  document.getElementById('trapBtn').onclick=()=>{
    const val=document.getElementById('trapInput').value.trim();
    if(val==='6666666'){
      modalBackdrop.style.display='none';
      renderMaze();
    } else {
      alert("Erreur ! Retente le calcul !");
    }
  };
}
function showExit(){
  modal.innerHTML=`
    <h2>Félicitations !</h2>
    <p>Le mot de passe est : ENVOIE UN MESSAGE PRIVE A HUSER6666666 QUI CERTIFIE SUR L'HONNEUR QUE TU NE DONNERAS CETTE SOLUTION A PERSONNE ET IL TE DONNERA LE MOT DE PASSE</p>
    <button onclick="window.location.reload()">Recommencer</button>
  `;
  modalBackdrop.style.display='flex';
}

window.addEventListener('keydown',e=>{
  switch(e.key.toLowerCase()){
    case 'z': case 'arrowup': move(-1,0); break;
    case 's': case 'arrowdown': move(1,0); break;
    case 'q': case 'arrowleft': move(0,-1); break;
    case 'd': case 'arrowright': move(0,1); break;
  }
});

initMaze();
renderMaze();
</script>
</body>
</html>
